{
  "id": "supabase-edge-functions",
  "name": "supabase-edge-functions",
  "version": "1.0.0",
  "summary": "Deploy and manage Supabase Edge Functions. Use for invoking serverless functions, deploying new functions, and managing function deployments.",
  "description": "# Supabase Edge Functions\n\n## Overview\n\nThis skill provides operations for working with Supabase Edge Functions - serverless TypeScript/JavaScript functions that run on Deno Deploy. Use for invoking functions, deploying code, and managing function lifecycles.\n\n## Prerequisites\n\n**Required environment variables:**\n```bash\nexport SUPABASE_URL=\"https://your-project.supabase.co\"\nexport SUPABASE_KEY=\"your-anon-or-service-role-key\"\n```\n\n**Required tools:**\n- Supabase CLI (`supabase` command)\n- Deno (for local development)\n\n**Install Supabase CLI:**\n```bash\n# macOS\nbrew install supabase/tap/supabase\n\n# Linux\ncurl -fsSL https://github.com/supabase/cli/releases/latest/download/supabase_linux_amd64.tar.gz | tar -xz\nsudo mv supabase /usr/local/bin/\n\n# Windows (PowerShell)\nscoop bucket add supabase https://github.com/supabase/scoop-bucket.git\nscoop install supabase\n```\n\n**Helper script:**\nThis skill uses the shared Supabase API helper for invoking functions:\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n```\n\n## Invoke Edge Functions\n\n### Basic Invocation\n\n**Invoke a function with POST:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nFUNCTION_NAME=\"hello-world\"\n\nsupabase_post \"/functions/v1/${FUNCTION_NAME}\" '{\n  \"name\": \"Alice\"\n}'\n```\n\n**Invoke with GET:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nFUNCTION_NAME=\"get-data\"\n\nsupabase_get \"/functions/v1/${FUNCTION_NAME}?id=123\"\n```\n\n### Invoke with Headers\n\n**Pass custom headers:**\n```bash\nFUNCTION_NAME=\"authenticated-function\"\nUSER_TOKEN=\"user-access-token\"\n\ncurl -s -X POST \\\n    \"${SUPABASE_URL}/functions/v1/${FUNCTION_NAME}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${USER_TOKEN}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\"action\": \"process\"}'\n```\n\n### Invoke with Authentication\n\n**Invoke function as authenticated user:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nFUNCTION_NAME=\"user-profile\"\nACCESS_TOKEN=\"user-jwt-token\"\n\ncurl -s -X POST \\\n    \"${SUPABASE_URL}/functions/v1/${FUNCTION_NAME}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${ACCESS_TOKEN}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{}'\n```\n\n## Function Management (CLI)\n\n### Initialize Function\n\n**Create a new edge function:**\n```bash\n# Navigate to your Supabase project directory\ncd /path/to/project\n\n# Create new function\nsupabase functions new my-function\n\n# This creates: supabase/functions/my-function/index.ts\n```\n\n### Function Template\n\n**Basic function structure:**\n```typescript\n// supabase/functions/my-function/index.ts\n\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\"\n\nserve(async (req) => {\n  const { name } = await req.json()\n\n  const data = {\n    message: `Hello ${name}!`,\n  }\n\n  return new Response(\n    JSON.stringify(data),\n    { headers: { \"Content-Type\": \"application/json\" } },\n  )\n})\n```\n\n**Function with authentication:**\n```typescript\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\"\nimport { createClient } from 'https://esm.sh/@supabase/supabase-js@2'\n\nserve(async (req) => {\n  // Get JWT from Authorization header\n  const authHeader = req.headers.get('Authorization')!\n  const token = authHeader.replace('Bearer ', '')\n\n  // Create Supabase client with user's token\n  const supabase = createClient(\n    Deno.env.get('SUPABASE_URL') ?? '',\n    Deno.env.get('SUPABASE_ANON_KEY') ?? '',\n    { global: { headers: { Authorization: authHeader } } }\n  )\n\n  // Get authenticated user\n  const { data: { user }, error } = await supabase.auth.getUser(token)\n\n  if (error || !user) {\n    return new Response('Unauthorized', { status: 401 })\n  }\n\n  return new Response(\n    JSON.stringify({ message: `Hello ${user.email}!` }),\n    { headers: { \"Content-Type\": \"application/json\" } },\n  )\n})\n```\n\n### Deploy Function\n\n**Deploy a function to Supabase:**\n```bash\n# Login to Supabase (first time only)\nsupabase login\n\n# Link to your project (first time only)\nsupabase link --project-ref your-project-ref\n\n# Deploy specific function\nsupabase functions deploy my-function\n\n# Deploy with custom environment variables\nsupabase functions deploy my-function \\\n  --env-file ./supabase/.env.local\n\n# Deploy all functions\nsupabase functions deploy\n```\n\n### Set Environment Variables\n\n**Set secrets for edge functions:**\n```bash\n# Set individual secret\nsupabase secrets set MY_SECRET_KEY=value123\n\n# Set multiple secrets from file\n# Create .env file:\n# API_KEY=abc123\n# DATABASE_URL=postgres://...\n\nsupabase secrets set --env-file .env\n\n# List secrets (names only, not values)\nsupabase secrets list\n\n# Unset secret\nsupabase secrets unset MY_SECRET_KEY\n```\n\n### Local Development\n\n**Run functions locally:**\n```bash\n# Start local Supabase (includes edge functions)\nsupabase start\n\n# Serve functions locally\nsupabase functions serve\n\n# Serve specific function\nsupabase functions serve my-function --env-file ./supabase/.env.local\n\n# Invoke local function\ncurl http://localhost:54321/functions/v1/my-function \\\n  -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n  -d '{\"name\": \"test\"}'\n```\n\n### Delete Function\n\n**Remove a deployed function:**\n```bash\n# Delete function from Supabase dashboard or using SQL\n# Note: No direct CLI command to delete, must use dashboard\n\n# Remove local function file\nrm -rf supabase/functions/my-function\n```\n\n## Common Patterns\n\n### Invoke and Process Response\n\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nFUNCTION_NAME=\"process-data\"\n\nresponse=$(supabase_post \"/functions/v1/${FUNCTION_NAME}\" '{\n  \"action\": \"calculate\",\n  \"values\": [1, 2, 3, 4, 5]\n}')\n\nif [[ $? -eq 0 ]]; then\n    result=$(echo \"$response\" | jq -r '.result')\n    echo \"Function result: $result\"\nelse\n    echo \"Function invocation failed\"\n    exit 1\nfi\n```\n\n### Batch Function Invocations\n\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nFUNCTION_NAME=\"send-email\"\nRECIPIENTS=(\"alice@example.com\" \"bob@example.com\" \"charlie@example.com\")\n\nfor email in \"${RECIPIENTS[@]}\"; do\n    echo \"Processing $email...\"\n\n    supabase_post \"/functions/v1/${FUNCTION_NAME}\" '{\n      \"to\": \"'\"$email\"'\",\n      \"subject\": \"Hello\",\n      \"body\": \"Test message\"\n    }'\n\n    echo \"✓ Sent to $email\"\ndone\n```\n\n### Function with Retry Logic\n\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\ninvoke_with_retry() {\n    local function_name=\"$1\"\n    local payload=\"$2\"\n    local max_retries=3\n    local retry_count=0\n\n    while [[ $retry_count -lt $max_retries ]]; do\n        if response=$(supabase_post \"/functions/v1/${function_name}\" \"$payload\" 2>&1); then\n            echo \"$response\"\n            return 0\n        else\n            retry_count=$((retry_count + 1))\n            echo \"Retry $retry_count/$max_retries...\" >&2\n            sleep 2\n        fi\n    done\n\n    echo \"Function failed after $max_retries retries\" >&2\n    return 1\n}\n\n# Use it\ninvoke_with_retry \"my-function\" '{\"action\": \"process\"}'\n```\n\n### Deploy Function Script\n\n```bash\n#!/bin/bash\n# deploy-function.sh\n\nFUNCTION_NAME=\"${1:-my-function}\"\n\necho \"Deploying function: $FUNCTION_NAME\"\n\n# Validate function exists\nif [[ ! -d \"supabase/functions/$FUNCTION_NAME\" ]]; then\n    echo \"Error: Function $FUNCTION_NAME not found\"\n    exit 1\nfi\n\n# Deploy\nif supabase functions deploy \"$FUNCTION_NAME\"; then\n    echo \"✓ Deployed successfully\"\n\n    # Test invocation\n    echo \"Testing function...\"\n    response=$(curl -s -X POST \\\n        \"${SUPABASE_URL}/functions/v1/${FUNCTION_NAME}\" \\\n        -H \"apikey: ${SUPABASE_KEY}\" \\\n        -H \"Content-Type: application/json\" \\\n        -d '{}')\n\n    echo \"Test response: $response\"\nelse\n    echo \"✗ Deployment failed\"\n    exit 1\nfi\n```\n\n### Monitor Function Logs\n\n```bash\n# View function logs (requires Supabase CLI)\nsupabase functions logs my-function\n\n# Follow logs in real-time\nsupabase functions logs my-function --follow\n\n# Filter logs by level\nsupabase functions logs my-function --level error\n\n# View logs from specific time\nsupabase functions logs my-function --since 1h\n```\n\n## Advanced Patterns\n\n### Function with Database Access\n\n```typescript\n// supabase/functions/get-user-data/index.ts\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\"\nimport { createClient } from 'https://esm.sh/@supabase/supabase-js@2'\n\nserve(async (req) => {\n  const supabase = createClient(\n    Deno.env.get('SUPABASE_URL') ?? '',\n    Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''\n  )\n\n  const { userId } = await req.json()\n\n  const { data, error } = await supabase\n    .from('users')\n    .select('*')\n    .eq('id', userId)\n    .single()\n\n  if (error) {\n    return new Response(JSON.stringify({ error: error.message }), {\n      status: 400,\n      headers: { 'Content-Type': 'application/json' }\n    })\n  }\n\n  return new Response(JSON.stringify(data), {\n    headers: { 'Content-Type': 'application/json' }\n  })\n})\n```\n\n### Function with External API Call\n\n```typescript\n// supabase/functions/fetch-weather/index.ts\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\"\n\nserve(async (req) => {\n  const { city } = await req.json()\n  const apiKey = Deno.env.get('WEATHER_API_KEY')\n\n  const response = await fetch(\n    `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}`\n  )\n\n  const data = await response.json()\n\n  return new Response(JSON.stringify(data), {\n    headers: { 'Content-Type': 'application/json' }\n  })\n})\n```\n\n### Scheduled Function (Cron)\n\n```typescript\n// supabase/functions/daily-cleanup/index.ts\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\"\nimport { createClient } from 'https://esm.sh/@supabase/supabase-js@2'\n\nserve(async (req) => {\n  // Verify request is from Supabase Cron\n  const authHeader = req.headers.get('Authorization')\n  if (authHeader !== `Bearer ${Deno.env.get('SUPABASE_SERVICE_ROLE_KEY')}`) {\n    return new Response('Unauthorized', { status: 401 })\n  }\n\n  const supabase = createClient(\n    Deno.env.get('SUPABASE_URL') ?? '',\n    Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''\n  )\n\n  // Delete old records\n  const { data, error } = await supabase\n    .from('logs')\n    .delete()\n    .lt('created_at', new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString())\n\n  return new Response(JSON.stringify({ deleted: data?.length ?? 0 }), {\n    headers: { 'Content-Type': 'application/json' }\n  })\n})\n```\n\n**Set up cron job in Supabase Dashboard:**\n```sql\n-- In SQL Editor, create pg_cron job:\nselect cron.schedule(\n  'daily-cleanup',\n  '0 2 * * *', -- Run at 2 AM daily\n  $$\n  select\n    net.http_post(\n      url := 'https://your-project.supabase.co/functions/v1/daily-cleanup',\n      headers := '{\"Content-Type\": \"application/json\", \"Authorization\": \"Bearer YOUR_SERVICE_ROLE_KEY\"}'::jsonb,\n      body := '{}'::jsonb\n    ) as request_id;\n  $$\n);\n```\n\n## Testing Functions\n\n### Test Locally\n\n```bash\n# Start local environment\nsupabase start\n\n# Serve function\nsupabase functions serve my-function\n\n# Test with curl\ncurl http://localhost:54321/functions/v1/my-function \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\" \\\n  -d '{\"test\": \"data\"}'\n```\n\n### Integration Test Script\n\n```bash\n#!/bin/bash\n# test-function.sh\n\nFUNCTION_NAME=\"$1\"\nTEST_CASES_FILE=\"$2\"\n\nif [[ ! -f \"$TEST_CASES_FILE\" ]]; then\n    echo \"Test cases file not found\"\n    exit 1\nfi\n\necho \"Testing function: $FUNCTION_NAME\"\n\nwhile IFS= read -r test_case; do\n    echo \"Test case: $test_case\"\n\n    response=$(curl -s -X POST \\\n        \"${SUPABASE_URL}/functions/v1/${FUNCTION_NAME}\" \\\n        -H \"apikey: ${SUPABASE_KEY}\" \\\n        -H \"Content-Type: application/json\" \\\n        -d \"$test_case\")\n\n    echo \"Response: $response\"\n    echo \"---\"\ndone < \"$TEST_CASES_FILE\"\n```\n\n## Error Handling\n\n**Function errors return HTTP status codes:**\n\n| Status | Meaning |\n|--------|---------|\n| 200 | Success |\n| 400 | Bad request (invalid input) |\n| 401 | Unauthorized (invalid/missing auth) |\n| 403 | Forbidden (insufficient permissions) |\n| 500 | Internal server error (function crashed) |\n| 504 | Gateway timeout (function took too long) |\n\n**Timeout limit:** Edge functions have a 2-second CPU time limit and 150-second wall clock timeout.\n\n## Security Best Practices\n\n1. **Validate input**: Always validate and sanitize request data\n2. **Use service role key carefully**: Only in admin functions, never expose to clients\n3. **Implement authentication**: Check user tokens for protected functions\n4. **Rate limiting**: Implement rate limiting for public functions\n5. **Environment variables**: Store secrets in Supabase secrets, not in code\n6. **CORS**: Configure CORS headers appropriately\n7. **Error messages**: Don't leak sensitive information in error responses\n\n## Performance Tips\n\n1. **Cold starts**: Functions may have cold starts (100-200ms delay)\n2. **Keep functions small**: Faster cold starts and easier debugging\n3. **Cache external data**: Use in-memory caching for repeated API calls\n4. **Parallel execution**: Use `Promise.all()` for concurrent operations\n5. **Stream large responses**: Use streaming for large data transfers\n\n## API Documentation\n\n- Supabase Edge Functions: https://supabase.com/docs/guides/functions\n- Deno Deploy: https://deno.com/deploy/docs",
  "verticals": [
    "engineering"
  ],
  "tags": [],
  "author": {
    "name": "Nice-Wolf-Studio",
    "github": "Nice-Wolf-Studio"
  },
  "status": "ready",
  "verified": false,
  "visibility": "public",
  "license": "MIT",
  "links": {
    "repo": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills",
    "skill_md": "https://raw.githubusercontent.com/Nice-Wolf-Studio/claude-code-supabase-skills/main/skills/supabase-edge-functions/SKILL.md"
  },
  "stats": {
    "stars": 7,
    "forks": 0,
    "installs": 0
  },
  "last_updated": "2026-01-02T07:56:55Z",
  "created_at": "2025-10-20T05:33:10Z",
  "meta": {
    "source": "github",
    "sourceUrl": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills/blob/main/skills/supabase-edge-functions/SKILL.md",
    "harvestedAt": "2026-01-07T16:59:54.890Z",
    "uniqueId": "sk_5b0c8e2e1660"
  }
}