{
  "id": "supabase-auth",
  "name": "supabase-auth",
  "version": "1.0.0",
  "summary": "Manage authentication and user operations in Supabase. Use for sign up, sign in, sign out, password resets, and user management.",
  "description": "# Supabase Authentication\n\n## Overview\n\nThis skill provides authentication and user management operations through the Supabase Auth API. Supports email/password authentication, session management, user metadata, and password recovery.\n\n## Prerequisites\n\n**Required environment variables:**\n```bash\nexport SUPABASE_URL=\"https://your-project.supabase.co\"\nexport SUPABASE_KEY=\"your-anon-or-service-role-key\"\n```\n\n**Helper script:**\nThis skill uses the shared Supabase API helper. Make sure to source it:\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n```\n\n## Common Operations\n\n### Sign Up - Create New User\n\n**Basic email/password signup:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_post \"/auth/v1/signup\" '{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\"\n}'\n```\n\n**Signup with user metadata:**\n```bash\nsupabase_post \"/auth/v1/signup\" '{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\",\n  \"data\": {\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"age\": 30\n  }\n}'\n```\n\n**Auto-confirm user (requires service role key):**\n```bash\n# Note: Use SUPABASE_KEY with service_role key for this\nsupabase_post \"/auth/v1/signup\" '{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\",\n  \"email_confirm\": true\n}'\n```\n\n### Sign In - Authenticate User\n\n**Email/password login:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nresponse=$(supabase_post \"/auth/v1/token?grant_type=password\" '{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\"\n}')\n\n# Extract access token\naccess_token=$(echo \"$response\" | jq -r '.access_token')\nrefresh_token=$(echo \"$response\" | jq -r '.refresh_token')\n\necho \"Access Token: $access_token\"\necho \"Refresh Token: $refresh_token\"\n```\n\n**Response includes:**\n- `access_token` - JWT token for authenticated requests\n- `refresh_token` - Token to get new access token when expired\n- `user` - User object with id, email, metadata\n- `expires_in` - Token expiration time in seconds\n\n### Get Current User\n\n**Retrieve user info with access token:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\n# Set your access token from login\nACCESS_TOKEN=\"eyJhbGc...\"\n\ncurl -s -X GET \\\n    \"${SUPABASE_URL}/auth/v1/user\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${ACCESS_TOKEN}\"\n```\n\n### Update User\n\n**Update user metadata:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nACCESS_TOKEN=\"eyJhbGc...\"\n\ncurl -s -X PUT \\\n    \"${SUPABASE_URL}/auth/v1/user\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${ACCESS_TOKEN}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"data\": {\n        \"first_name\": \"Jane\",\n        \"avatar_url\": \"https://example.com/avatar.jpg\"\n      }\n    }'\n```\n\n**Update email:**\n```bash\ncurl -s -X PUT \\\n    \"${SUPABASE_URL}/auth/v1/user\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${ACCESS_TOKEN}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"email\": \"newemail@example.com\"\n    }'\n```\n\n**Update password:**\n```bash\ncurl -s -X PUT \\\n    \"${SUPABASE_URL}/auth/v1/user\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${ACCESS_TOKEN}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"password\": \"newsecurepassword123\"\n    }'\n```\n\n### Sign Out\n\n**Sign out user (invalidate refresh token):**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nACCESS_TOKEN=\"eyJhbGc...\"\n\ncurl -s -X POST \\\n    \"${SUPABASE_URL}/auth/v1/logout\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${ACCESS_TOKEN}\"\n```\n\n### Refresh Token\n\n**Get new access token using refresh token:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nREFRESH_TOKEN=\"your-refresh-token\"\n\nsupabase_post \"/auth/v1/token?grant_type=refresh_token\" '{\n  \"refresh_token\": \"'\"${REFRESH_TOKEN}\"'\"\n}'\n```\n\n### Password Recovery\n\n**Send password reset email:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_post \"/auth/v1/recover\" '{\n  \"email\": \"user@example.com\"\n}'\n```\n\n**Reset password with recovery token:**\n```bash\n# This is typically done through email link\n# The recovery token comes from the email link\n\nRECOVERY_TOKEN=\"token-from-email\"\n\ncurl -s -X PUT \\\n    \"${SUPABASE_URL}/auth/v1/user\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${RECOVERY_TOKEN}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"password\": \"newpassword123\"\n    }'\n```\n\n### Resend Confirmation Email\n\n**Resend email verification:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_post \"/auth/v1/resend\" '{\n  \"type\": \"signup\",\n  \"email\": \"user@example.com\"\n}'\n```\n\n## Admin Operations (Service Role Key Required)\n\n### List All Users\n\n**Get all users (requires service role key):**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\n# Make sure SUPABASE_KEY is set to service_role key\nsupabase_get \"/auth/v1/admin/users\"\n```\n\n**Paginated user list:**\n```bash\n# Get users with pagination\nsupabase_get \"/auth/v1/admin/users?page=1&per_page=50\"\n```\n\n### Get User by ID\n\n**Retrieve specific user (requires service role key):**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nUSER_ID=\"user-uuid-here\"\n\nsupabase_get \"/auth/v1/admin/users/${USER_ID}\"\n```\n\n### Create User (Admin)\n\n**Create user without email confirmation:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_post \"/auth/v1/admin/users\" '{\n  \"email\": \"admin-created@example.com\",\n  \"password\": \"securepassword123\",\n  \"email_confirm\": true,\n  \"user_metadata\": {\n    \"first_name\": \"Admin\",\n    \"last_name\": \"Created\"\n  }\n}'\n```\n\n### Update User (Admin)\n\n**Update user as admin:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nUSER_ID=\"user-uuid-here\"\n\ncurl -s -X PUT \\\n    \"${SUPABASE_URL}/auth/v1/admin/users/${USER_ID}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"email\": \"updated@example.com\",\n      \"user_metadata\": {\n        \"role\": \"admin\"\n      }\n    }'\n```\n\n### Delete User (Admin)\n\n**Delete user account:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nUSER_ID=\"user-uuid-here\"\n\nsupabase_delete \"/auth/v1/admin/users/${USER_ID}\"\n```\n\n## Common Patterns\n\n### Login and Store Tokens\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\n# Login\nresponse=$(supabase_post \"/auth/v1/token?grant_type=password\" '{\n  \"email\": \"user@example.com\",\n  \"password\": \"password123\"\n}')\n\n# Extract tokens\naccess_token=$(echo \"$response\" | jq -r '.access_token')\nrefresh_token=$(echo \"$response\" | jq -r '.refresh_token')\nuser_id=$(echo \"$response\" | jq -r '.user.id')\n\n# Store in environment or file for subsequent requests\nexport SUPABASE_ACCESS_TOKEN=\"$access_token\"\nexport SUPABASE_REFRESH_TOKEN=\"$refresh_token\"\nexport SUPABASE_USER_ID=\"$user_id\"\n\necho \"Logged in as user: $user_id\"\n```\n\n### Check if User Exists\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\n# Note: This requires service role key and admin endpoint\nemail=\"check@example.com\"\n\nusers=$(supabase_get \"/auth/v1/admin/users\")\nexists=$(echo \"$users\" | jq --arg email \"$email\" '.users[] | select(.email == $email)')\n\nif [[ -n \"$exists\" ]]; then\n    echo \"User exists\"\nelse\n    echo \"User does not exist\"\nfi\n```\n\n### Verify JWT Token\n```bash\n# Tokens are JWTs - you can decode them (requires jq)\nACCESS_TOKEN=\"eyJhbGc...\"\n\n# Decode payload (base64)\npayload=$(echo \"$ACCESS_TOKEN\" | cut -d. -f2 | base64 -d 2>/dev/null)\necho \"$payload\" | jq '.'\n\n# Check expiration\nexp=$(echo \"$payload\" | jq -r '.exp')\nnow=$(date +%s)\n\nif [[ $now -gt $exp ]]; then\n    echo \"Token expired\"\nelse\n    echo \"Token valid\"\nfi\n```\n\n## Error Handling\n\nCommon error responses:\n\n| Status | Error | Meaning |\n|--------|-------|---------|\n| 400 | Invalid login credentials | Wrong email or password |\n| 400 | User already registered | Email already exists |\n| 401 | Invalid token | Access token expired or invalid |\n| 422 | Validation error | Invalid email format or weak password |\n| 429 | Too many requests | Rate limit exceeded |\n\n```bash\nif response=$(supabase_post \"/auth/v1/token?grant_type=password\" '{...}' 2>&1); then\n    echo \"Login successful\"\n    access_token=$(echo \"$response\" | jq -r '.access_token')\nelse\n    echo \"Login failed: $response\"\n    exit 1\nfi\n```\n\n## Security Best Practices\n\n1. **Never commit credentials**: Store tokens in environment variables or secure files\n2. **Use anon key for client operations**: Public-facing authentication\n3. **Use service role key carefully**: Admin operations only, never expose to clients\n4. **Implement token refresh**: Refresh access tokens before they expire\n5. **Enable RLS**: Configure Row Level Security policies in Supabase dashboard\n6. **Validate tokens server-side**: Don't trust client-provided tokens without verification\n\n## Session Management\n\n**Typical flow:**\n1. User signs in → Get access_token and refresh_token\n2. Store tokens securely\n3. Use access_token in Authorization header for authenticated requests\n4. When access_token expires → Use refresh_token to get new access_token\n5. User signs out → Invalidate refresh_token\n\n**Token lifespan:**\n- Access token: 1 hour (default)\n- Refresh token: 30 days (default)\n\n## API Documentation\n\nFull Supabase Auth API documentation: https://supabase.com/docs/guides/auth",
  "verticals": [
    "operations"
  ],
  "tags": [],
  "author": {
    "name": "Nice-Wolf-Studio",
    "github": "Nice-Wolf-Studio"
  },
  "status": "ready",
  "verified": false,
  "visibility": "public",
  "license": "MIT",
  "links": {
    "repo": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills",
    "skill_md": "https://raw.githubusercontent.com/Nice-Wolf-Studio/claude-code-supabase-skills/main/skills/supabase-auth/SKILL.md"
  },
  "stats": {
    "stars": 7,
    "forks": 0,
    "installs": 0
  },
  "last_updated": "2026-01-02T07:56:55Z",
  "created_at": "2025-10-20T05:33:10Z",
  "meta": {
    "source": "github",
    "sourceUrl": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills/blob/main/skills/supabase-auth/SKILL.md",
    "harvestedAt": "2026-01-07T16:59:54.890Z",
    "uniqueId": "sk_4748915222b7"
  }
}