{
  "id": "supabase-storage",
  "name": "supabase-storage",
  "version": "1.0.0",
  "summary": "Manage file storage operations in Supabase Storage. Use for uploading, downloading, listing, and deleting files in buckets.",
  "description": "# Supabase Storage Operations\n\n## Overview\n\nThis skill provides file storage operations through the Supabase Storage API. Supports bucket management, file uploads/downloads, listing files, generating URLs, and managing access control.\n\n## Prerequisites\n\n**Required environment variables:**\n```bash\nexport SUPABASE_URL=\"https://your-project.supabase.co\"\nexport SUPABASE_KEY=\"your-anon-or-service-role-key\"\n```\n\n**Helper script:**\nThis skill uses the shared Supabase API helper. Make sure to source it:\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n```\n\n## Bucket Operations\n\n### List Buckets\n\n**Get all storage buckets:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_get \"/storage/v1/bucket\"\n```\n\n### Create Bucket\n\n**Create a new storage bucket:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\n# Public bucket\nsupabase_post \"/storage/v1/bucket\" '{\n  \"name\": \"avatars\",\n  \"public\": true\n}'\n\n# Private bucket\nsupabase_post \"/storage/v1/bucket\" '{\n  \"name\": \"private-documents\",\n  \"public\": false,\n  \"file_size_limit\": 52428800,\n  \"allowed_mime_types\": [\"image/png\", \"image/jpeg\", \"application/pdf\"]\n}'\n```\n\n### Get Bucket Details\n\n**Retrieve bucket information:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_get \"/storage/v1/bucket/avatars\"\n```\n\n### Update Bucket\n\n**Update bucket settings:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\ncurl -s -X PUT \\\n    \"${SUPABASE_URL}/storage/v1/bucket/avatars\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"public\": false,\n      \"file_size_limit\": 10485760\n    }'\n```\n\n### Delete Bucket\n\n**Delete a bucket (must be empty):**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_delete \"/storage/v1/bucket/old-bucket\"\n```\n\n### Empty Bucket\n\n**Delete all files in a bucket:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nsupabase_post \"/storage/v1/bucket/avatars/empty\" '{}'\n```\n\n## File Operations\n\n### Upload File\n\n**Upload a file to storage:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nFILE_PATH=\"/path/to/local/image.jpg\"\nSTORAGE_PATH=\"user-123/profile.jpg\"\n\ncurl -s -X POST \\\n    \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -F \"file=@${FILE_PATH}\"\n```\n\n**Upload with upsert (overwrite if exists):**\n```bash\ncurl -s -X POST \\\n    \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -H \"x-upsert: true\" \\\n    -F \"file=@${FILE_PATH}\"\n```\n\n**Upload with content type:**\n```bash\ncurl -s -X POST \\\n    \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -H \"Content-Type: image/jpeg\" \\\n    -F \"file=@${FILE_PATH}\"\n```\n\n### Download File\n\n**Download a file from storage:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nSTORAGE_PATH=\"user-123/profile.jpg\"\nOUTPUT_FILE=\"/path/to/save/downloaded.jpg\"\n\ncurl -s -X GET \\\n    \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -o \"${OUTPUT_FILE}\"\n```\n\n**Download to stdout (pipe to other commands):**\n```bash\ncurl -s -X GET \\\n    \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\"\n```\n\n### List Files\n\n**List files in a bucket:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\n\nsupabase_post \"/storage/v1/object/list/${BUCKET_NAME}\" '{\n  \"limit\": 100,\n  \"offset\": 0,\n  \"sortBy\": {\n    \"column\": \"name\",\n    \"order\": \"asc\"\n  }\n}'\n```\n\n**List files in a specific folder:**\n```bash\nsupabase_post \"/storage/v1/object/list/${BUCKET_NAME}\" '{\n  \"prefix\": \"user-123/\",\n  \"limit\": 100\n}'\n```\n\n**Search files:**\n```bash\nsupabase_post \"/storage/v1/object/list/${BUCKET_NAME}\" '{\n  \"search\": \"profile\",\n  \"limit\": 50\n}'\n```\n\n### Delete File\n\n**Delete a single file:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nSTORAGE_PATH=\"user-123/old-profile.jpg\"\n\nsupabase_delete \"/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\"\n```\n\n**Delete multiple files:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\n\nsupabase_delete \"/storage/v1/object/${BUCKET_NAME}\" -d '{\n  \"prefixes\": [\"user-123/temp/\", \"user-456/draft/\"]\n}'\n```\n\n### Move/Rename File\n\n**Move or rename a file:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nFROM_PATH=\"user-123/temp.jpg\"\nTO_PATH=\"user-123/final.jpg\"\n\nsupabase_post \"/storage/v1/object/move\" '{\n  \"bucketId\": \"'\"${BUCKET_NAME}\"'\",\n  \"sourceKey\": \"'\"${FROM_PATH}\"'\",\n  \"destinationKey\": \"'\"${TO_PATH}\"'\"\n}'\n```\n\n### Copy File\n\n**Copy a file to another location:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nSOURCE_PATH=\"user-123/profile.jpg\"\nDEST_PATH=\"user-123/profile-backup.jpg\"\n\nsupabase_post \"/storage/v1/object/copy\" '{\n  \"bucketId\": \"'\"${BUCKET_NAME}\"'\",\n  \"sourceKey\": \"'\"${SOURCE_PATH}\"'\",\n  \"destinationKey\": \"'\"${DEST_PATH}\"'\"\n}'\n```\n\n## URL Generation\n\n### Get Public URL\n\n**Get public URL for a file (public buckets only):**\n```bash\nBUCKET_NAME=\"avatars\"\nSTORAGE_PATH=\"user-123/profile.jpg\"\n\nPUBLIC_URL=\"${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/${STORAGE_PATH}\"\necho \"Public URL: $PUBLIC_URL\"\n```\n\n### Create Signed URL\n\n**Generate a signed URL for temporary access:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"private-documents\"\nSTORAGE_PATH=\"user-123/secret.pdf\"\nEXPIRES_IN=3600  # 1 hour in seconds\n\nsupabase_post \"/storage/v1/object/sign/${BUCKET_NAME}/${STORAGE_PATH}\" '{\n  \"expiresIn\": '\"${EXPIRES_IN}\"'\n}'\n```\n\nResponse will include:\n```json\n{\n  \"signedURL\": \"/storage/v1/object/sign/private-documents/user-123/secret.pdf?token=...\"\n}\n```\n\nFull URL:\n```bash\nsigned_path=$(supabase_post \"/storage/v1/object/sign/${BUCKET_NAME}/${STORAGE_PATH}\" '{\"expiresIn\": 3600}' | jq -r '.signedURL')\nfull_url=\"${SUPABASE_URL}${signed_path}\"\necho \"Signed URL: $full_url\"\n```\n\n### Create Multiple Signed URLs\n\n**Generate signed URLs for multiple files:**\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"private-documents\"\n\nsupabase_post \"/storage/v1/object/sign/${BUCKET_NAME}\" '{\n  \"paths\": [\"doc1.pdf\", \"doc2.pdf\", \"folder/doc3.pdf\"],\n  \"expiresIn\": 3600\n}'\n```\n\n## Common Patterns\n\n### Upload with Progress\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"uploads\"\nFILE_PATH=\"/path/to/large-file.zip\"\nSTORAGE_PATH=\"user-123/backup.zip\"\n\necho \"Uploading ${FILE_PATH}...\"\n\ncurl -X POST \\\n    \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -F \"file=@${FILE_PATH}\" \\\n    --progress-bar -o /dev/null\n\nif [[ $? -eq 0 ]]; then\n    echo \"Upload successful!\"\nelse\n    echo \"Upload failed!\"\n    exit 1\nfi\n```\n\n### Check if File Exists\n```bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nSTORAGE_PATH=\"user-123/profile.jpg\"\n\n# Try to get file info\nresponse=$(curl -s -X GET \\\n    \"${SUPABASE_URL}/storage/v1/object/info/${BUCKET_NAME}/${STORAGE_PATH}\" \\\n    -H \"apikey: ${SUPABASE_KEY}\" \\\n    -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n    -w \"\\n%{http_code}\")\n\nhttp_code=$(echo \"$response\" | tail -n1)\n\nif [[ $http_code -eq 200 ]]; then\n    echo \"File exists\"\nelse\n    echo \"File does not exist\"\nfi\n```\n\n### Batch Upload Files\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"uploads\"\nLOCAL_DIR=\"/path/to/files\"\n\nfor file in \"$LOCAL_DIR\"/*; do\n    filename=$(basename \"$file\")\n    echo \"Uploading $filename...\"\n\n    curl -s -X POST \\\n        \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/batch/${filename}\" \\\n        -H \"apikey: ${SUPABASE_KEY}\" \\\n        -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n        -F \"file=@${file}\"\n\n    echo \"✓ Uploaded $filename\"\ndone\n```\n\n### Download All Files from Bucket\n```bash\n#!/bin/bash\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nBUCKET_NAME=\"avatars\"\nOUTPUT_DIR=\"/path/to/download\"\n\nmkdir -p \"$OUTPUT_DIR\"\n\n# Get file list\nfiles=$(supabase_post \"/storage/v1/object/list/${BUCKET_NAME}\" '{\"limit\": 1000}')\n\n# Download each file\necho \"$files\" | jq -r '.[].name' | while read -r filename; do\n    echo \"Downloading $filename...\"\n\n    curl -s -X GET \\\n        \"${SUPABASE_URL}/storage/v1/object/${BUCKET_NAME}/${filename}\" \\\n        -H \"apikey: ${SUPABASE_KEY}\" \\\n        -H \"Authorization: Bearer ${SUPABASE_KEY}\" \\\n        -o \"${OUTPUT_DIR}/${filename}\"\n\n    echo \"✓ Downloaded $filename\"\ndone\n```\n\n## Image Transformations\n\n**Transform images on-the-fly (public buckets):**\n```bash\nBUCKET_NAME=\"avatars\"\nSTORAGE_PATH=\"user-123/profile.jpg\"\n\n# Resize to width 200px\nTRANSFORMED_URL=\"${SUPABASE_URL}/storage/v1/render/image/public/${BUCKET_NAME}/${STORAGE_PATH}?width=200\"\n\n# Resize with quality\nTRANSFORMED_URL=\"${SUPABASE_URL}/storage/v1/render/image/public/${BUCKET_NAME}/${STORAGE_PATH}?width=200&quality=80\"\n\n# Multiple transformations\nTRANSFORMED_URL=\"${SUPABASE_URL}/storage/v1/render/image/public/${BUCKET_NAME}/${STORAGE_PATH}?width=300&height=300&resize=contain\"\n```\n\n## Access Control\n\n**Storage access is controlled by Storage Policies (RLS) in your Supabase dashboard.**\n\nCommon policy examples:\n\n**Public read, authenticated write:**\n```sql\n-- Set in Supabase Dashboard > Storage > Policies\n-- Allow public to read\nSELECT: true for all users\n\n-- Allow authenticated users to upload their own files\nINSERT: auth.uid() = (storage.foldername(name))[1]\n```\n\n**User-specific folders:**\n```sql\n-- Users can only access files in their own folder\nSELECT: auth.uid() = (storage.foldername(name))[1]\nUPDATE: auth.uid() = (storage.foldername(name))[1]\nDELETE: auth.uid() = (storage.foldername(name))[1]\n```\n\n## Error Handling\n\nCommon errors:\n\n| Status | Error | Meaning |\n|--------|-------|---------|\n| 400 | Invalid bucket name | Bucket name contains invalid characters |\n| 404 | Object not found | File doesn't exist |\n| 409 | Bucket already exists | Bucket with that name exists |\n| 413 | Payload too large | File exceeds size limit |\n| 422 | Invalid MIME type | File type not allowed in bucket |\n\n## Security Best Practices\n\n1. **Use private buckets** for sensitive data\n2. **Implement Storage Policies** (RLS) for access control\n3. **Set file size limits** to prevent abuse\n4. **Restrict MIME types** to expected file types\n5. **Use signed URLs** for temporary access to private files\n6. **Organize files** in user-specific folders (e.g., `user-{uuid}/`)\n7. **Never expose service role key** to client applications\n\n## File Size Limits\n\n- Default max file size: 50MB\n- Can be configured per bucket up to 5GB (contact Supabase for larger)\n- Check bucket settings for current limit\n\n## API Documentation\n\nFull Supabase Storage API documentation: https://supabase.com/docs/guides/storage",
  "verticals": [
    "operations"
  ],
  "tags": [],
  "author": {
    "name": "Nice-Wolf-Studio",
    "github": "Nice-Wolf-Studio"
  },
  "status": "ready",
  "verified": false,
  "visibility": "public",
  "license": "MIT",
  "links": {
    "repo": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills",
    "skill_md": "https://raw.githubusercontent.com/Nice-Wolf-Studio/claude-code-supabase-skills/main/skills/supabase-storage/SKILL.md"
  },
  "stats": {
    "stars": 7,
    "forks": 0,
    "installs": 0
  },
  "last_updated": "2026-01-02T07:56:55Z",
  "created_at": "2025-10-20T05:33:10Z",
  "meta": {
    "source": "github",
    "sourceUrl": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills/blob/main/skills/supabase-storage/SKILL.md",
    "harvestedAt": "2026-01-07T16:59:54.890Z",
    "uniqueId": "sk_97c5d319dd6b"
  }
}