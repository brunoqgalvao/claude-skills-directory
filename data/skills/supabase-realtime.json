{
  "id": "supabase-realtime",
  "name": "supabase-realtime",
  "version": "1.0.0",
  "summary": "Subscribe to realtime changes in Supabase using WebSocket connections. Use for listening to database changes, presence tracking, and broadcast messaging.",
  "description": "# Supabase Realtime\n\n## Overview\n\nThis skill provides guidance for working with Supabase Realtime features. Realtime allows you to listen to database changes, broadcast messages, and track presence using WebSocket connections.\n\n**Note:** Realtime operations require WebSocket support, which is more complex in bash. This skill focuses on practical patterns and examples using available tools.\n\n## Prerequisites\n\n**Required environment variables:**\n```bash\nexport SUPABASE_URL=\"https://your-project.supabase.co\"\nexport SUPABASE_KEY=\"your-anon-or-service-role-key\"\n```\n\n**Additional tools:**\n- `websocat` or `wscat` for WebSocket connections\n- `jq` for JSON processing\n\n**Install websocat:**\n```bash\n# macOS\nbrew install websocat\n\n# Linux\nwget https://github.com/vi/websocat/releases/download/v1.12.0/websocat.x86_64-unknown-linux-musl\nchmod +x websocat.x86_64-unknown-linux-musl\nsudo mv websocat.x86_64-unknown-linux-musl /usr/local/bin/websocat\n```\n\n## WebSocket Connection\n\n**Connect to Supabase Realtime:**\n```bash\nSUPABASE_URL=\"https://your-project.supabase.co\"\nSUPABASE_KEY=\"your-anon-key\"\n\n# Extract WebSocket URL (replace https:// with wss://)\nWS_URL=$(echo \"$SUPABASE_URL\" | sed 's/https:/wss:/')\n\n# Connect to realtime\nwebsocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\"\n```\n\n## Database Change Subscriptions\n\n### Subscribe to Table Changes\n\n**Listen to all changes on a table:**\n```bash\n#!/bin/bash\n\nSUPABASE_URL=\"https://your-project.supabase.co\"\nSUPABASE_KEY=\"your-anon-key\"\nWS_URL=$(echo \"$SUPABASE_URL\" | sed 's/https:/wss:/')\n\n# Create subscription message\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:users\",\n  \"event\": \"phx_join\",\n  \"payload\": {},\n  \"ref\": \"1\"\n}'\n\n# Connect and subscribe\necho \"$SUB_MESSAGE\" | websocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\"\n```\n\n**Subscribe to specific events:**\n```bash\n# Listen for INSERT events only\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:users\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"postgres_changes\": [\n        {\n          \"event\": \"INSERT\",\n          \"schema\": \"public\",\n          \"table\": \"users\"\n        }\n      ]\n    }\n  },\n  \"ref\": \"1\"\n}'\n\necho \"$SUB_MESSAGE\" | websocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\"\n```\n\n**Subscribe to UPDATE events:**\n```bash\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:products\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"postgres_changes\": [\n        {\n          \"event\": \"UPDATE\",\n          \"schema\": \"public\",\n          \"table\": \"products\"\n        }\n      ]\n    }\n  },\n  \"ref\": \"1\"\n}'\n```\n\n**Subscribe to DELETE events:**\n```bash\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:posts\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"postgres_changes\": [\n        {\n          \"event\": \"DELETE\",\n          \"schema\": \"public\",\n          \"table\": \"posts\"\n        }\n      ]\n    }\n  },\n  \"ref\": \"1\"\n}'\n```\n\n**Subscribe to all events (*, INSERT, UPDATE, DELETE):**\n```bash\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:orders\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"postgres_changes\": [\n        {\n          \"event\": \"*\",\n          \"schema\": \"public\",\n          \"table\": \"orders\"\n        }\n      ]\n    }\n  },\n  \"ref\": \"1\"\n}'\n```\n\n### Filter Subscriptions\n\n**Listen to changes matching a filter:**\n```bash\n# Only listen to changes where status = 'active'\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:users\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"postgres_changes\": [\n        {\n          \"event\": \"*\",\n          \"schema\": \"public\",\n          \"table\": \"users\",\n          \"filter\": \"status=eq.active\"\n        }\n      ]\n    }\n  },\n  \"ref\": \"1\"\n}'\n```\n\n## Broadcast Messaging\n\n### Send Broadcast Message\n\n**Broadcast a message to a channel:**\n```bash\n#!/bin/bash\n\nSUPABASE_URL=\"https://your-project.supabase.co\"\nSUPABASE_KEY=\"your-anon-key\"\nWS_URL=$(echo \"$SUPABASE_URL\" | sed 's/https:/wss:/')\n\n# Join channel first\nJOIN_MESSAGE='{\n  \"topic\": \"realtime:chat-room-1\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"broadcast\": {\n        \"self\": true\n      }\n    }\n  },\n  \"ref\": \"1\"\n}'\n\n# Broadcast message\nBROADCAST_MESSAGE='{\n  \"topic\": \"realtime:chat-room-1\",\n  \"event\": \"broadcast\",\n  \"payload\": {\n    \"type\": \"message\",\n    \"event\": \"new_message\",\n    \"payload\": {\n      \"user\": \"Alice\",\n      \"message\": \"Hello, World!\"\n    }\n  },\n  \"ref\": \"2\"\n}'\n\n# Send messages\n{\n  echo \"$JOIN_MESSAGE\"\n  sleep 1\n  echo \"$BROADCAST_MESSAGE\"\n} | websocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\"\n```\n\n### Listen to Broadcast Messages\n\n**Receive broadcast messages:**\n```bash\n# Join channel and listen\nJOIN_MESSAGE='{\n  \"topic\": \"realtime:chat-room-1\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"broadcast\": {\n        \"self\": false\n      }\n    }\n  },\n  \"ref\": \"1\"\n}'\n\necho \"$JOIN_MESSAGE\" | websocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\"\n```\n\n## Presence Tracking\n\n### Track Presence\n\n**Join channel with presence:**\n```bash\nPRESENCE_MESSAGE='{\n  \"topic\": \"realtime:lobby\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"presence\": {\n        \"key\": \"user-123\"\n      }\n    }\n  },\n  \"ref\": \"1\"\n}'\n\n# Track presence state\nTRACK_MESSAGE='{\n  \"topic\": \"realtime:lobby\",\n  \"event\": \"presence\",\n  \"payload\": {\n    \"type\": \"presence\",\n    \"event\": \"track\",\n    \"payload\": {\n      \"user_id\": \"123\",\n      \"username\": \"Alice\",\n      \"status\": \"online\"\n    }\n  },\n  \"ref\": \"2\"\n}'\n```\n\n### Untrack Presence\n\n**Leave presence:**\n```bash\nUNTRACK_MESSAGE='{\n  \"topic\": \"realtime:lobby\",\n  \"event\": \"presence\",\n  \"payload\": {\n    \"type\": \"presence\",\n    \"event\": \"untrack\"\n  },\n  \"ref\": \"3\"\n}'\n```\n\n## Practical Patterns\n\n### Continuous Listener Script\n\n```bash\n#!/bin/bash\n# listen-to-changes.sh\n\nSUPABASE_URL=\"https://your-project.supabase.co\"\nSUPABASE_KEY=\"your-anon-key\"\nWS_URL=$(echo \"$SUPABASE_URL\" | sed 's/https:/wss:/')\nTABLE=\"users\"\n\necho \"Listening for changes on $TABLE table...\"\n\n# Subscribe to changes\nSUB_MESSAGE='{\n  \"topic\": \"realtime:public:'\"$TABLE\"'\",\n  \"event\": \"phx_join\",\n  \"payload\": {\n    \"config\": {\n      \"postgres_changes\": [\n        {\n          \"event\": \"*\",\n          \"schema\": \"public\",\n          \"table\": \"'\"$TABLE\"'\"\n        }\n      ]\n    }\n  },\n  \"ref\": \"1\"\n}'\n\n# Listen continuously\necho \"$SUB_MESSAGE\" | websocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\" | \\\nwhile IFS= read -r line; do\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $line\" | jq '.'\ndone\n```\n\n### Process Changes with Handler\n\n```bash\n#!/bin/bash\n# process-changes.sh\n\nhandle_insert() {\n    local record=\"$1\"\n    echo \"New record inserted:\"\n    echo \"$record\" | jq '.payload.record'\n\n    # Your custom logic here\n    # Example: Send notification, update cache, etc.\n}\n\nhandle_update() {\n    local old_record=\"$1\"\n    local new_record=\"$2\"\n    echo \"Record updated:\"\n    echo \"Old: $(echo \"$old_record\" | jq -c '.')\"\n    echo \"New: $(echo \"$new_record\" | jq -c '.')\"\n}\n\nhandle_delete() {\n    local record=\"$1\"\n    echo \"Record deleted:\"\n    echo \"$record\" | jq '.payload.old_record'\n}\n\n# Listen and process\nwebsocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\" | \\\nwhile IFS= read -r line; do\n    event_type=$(echo \"$line\" | jq -r '.payload.data.type // empty')\n\n    case \"$event_type\" in\n        \"INSERT\")\n            handle_insert \"$(echo \"$line\" | jq '.payload.data')\"\n            ;;\n        \"UPDATE\")\n            handle_update \\\n                \"$(echo \"$line\" | jq '.payload.data.old_record')\" \\\n                \"$(echo \"$line\" | jq '.payload.data.record')\"\n            ;;\n        \"DELETE\")\n            handle_delete \"$(echo \"$line\" | jq '.payload.data')\"\n            ;;\n    esac\ndone\n```\n\n### Multi-Table Listener\n\n```bash\n#!/bin/bash\n# listen-multiple-tables.sh\n\nTABLES=(\"users\" \"posts\" \"comments\")\n\nfor table in \"${TABLES[@]}\"; do\n    (\n        echo \"Starting listener for $table\"\n        SUB_MESSAGE='{\n          \"topic\": \"realtime:public:'\"$table\"'\",\n          \"event\": \"phx_join\",\n          \"payload\": {\n            \"config\": {\n              \"postgres_changes\": [{\"event\": \"*\", \"schema\": \"public\", \"table\": \"'\"$table\"'\"}]\n            }\n          },\n          \"ref\": \"1\"\n        }'\n\n        echo \"$SUB_MESSAGE\" | websocat \"${WS_URL}/realtime/v1/websocket?apikey=${SUPABASE_KEY}&vsn=1.0.0\" | \\\n        while IFS= read -r line; do\n            echo \"[$table] $line\"\n        done\n    ) &\ndone\n\nwait\n```\n\n## Message Format\n\n### Subscription Confirmation\n```json\n{\n  \"event\": \"phx_reply\",\n  \"payload\": {\n    \"response\": {\n      \"postgres_changes\": [\n        {\n          \"id\": \"12345\",\n          \"event\": \"*\",\n          \"schema\": \"public\",\n          \"table\": \"users\"\n        }\n      ]\n    },\n    \"status\": \"ok\"\n  },\n  \"ref\": \"1\",\n  \"topic\": \"realtime:public:users\"\n}\n```\n\n### INSERT Event\n```json\n{\n  \"event\": \"postgres_changes\",\n  \"payload\": {\n    \"data\": {\n      \"commit_timestamp\": \"2023-01-01T12:00:00Z\",\n      \"record\": {\n        \"id\": 123,\n        \"name\": \"John Doe\",\n        \"email\": \"john@example.com\"\n      },\n      \"schema\": \"public\",\n      \"table\": \"users\",\n      \"type\": \"INSERT\"\n    },\n    \"ids\": [12345]\n  },\n  \"topic\": \"realtime:public:users\"\n}\n```\n\n### UPDATE Event\n```json\n{\n  \"event\": \"postgres_changes\",\n  \"payload\": {\n    \"data\": {\n      \"commit_timestamp\": \"2023-01-01T12:00:00Z\",\n      \"old_record\": {\n        \"id\": 123,\n        \"name\": \"John Doe\"\n      },\n      \"record\": {\n        \"id\": 123,\n        \"name\": \"Jane Doe\"\n      },\n      \"schema\": \"public\",\n      \"table\": \"users\",\n      \"type\": \"UPDATE\"\n    }\n  }\n}\n```\n\n### DELETE Event\n```json\n{\n  \"event\": \"postgres_changes\",\n  \"payload\": {\n    \"data\": {\n      \"commit_timestamp\": \"2023-01-01T12:00:00Z\",\n      \"old_record\": {\n        \"id\": 123,\n        \"name\": \"John Doe\"\n      },\n      \"schema\": \"public\",\n      \"table\": \"users\",\n      \"type\": \"DELETE\"\n    }\n  }\n}\n```\n\n## Alternative: REST Polling\n\nFor simpler use cases where WebSockets are impractical, consider polling:\n\n```bash\n#!/bin/bash\n# poll-changes.sh\n\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../../scripts/supabase-api.sh\"\n\nLAST_TIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)\n\nwhile true; do\n    # Get records created/updated since last check\n    new_records=$(supabase_get \"/rest/v1/users?updated_at=gt.${LAST_TIMESTAMP}&order=updated_at.asc\")\n\n    if [[ \"$new_records\" != \"[]\" ]]; then\n        echo \"New changes detected:\"\n        echo \"$new_records\" | jq '.'\n\n        # Update timestamp\n        LAST_TIMESTAMP=$(echo \"$new_records\" | jq -r '.[-1].updated_at')\n    fi\n\n    # Poll every 5 seconds\n    sleep 5\ndone\n```\n\n## Realtime Configuration\n\n**Enable Realtime in Supabase Dashboard:**\n1. Go to Database > Replication\n2. Enable replication for tables you want to listen to\n3. Choose which events to publish (INSERT, UPDATE, DELETE)\n\n**Row Level Security:**\nRealtime respects RLS policies. Users only receive changes for rows they have access to.\n\n## Limitations\n\n- WebSocket connections require persistent connection management\n- Bash is not ideal for WebSocket handling (consider Node.js/Python for production)\n- Connection drops require reconnection logic\n- Realtime is subject to connection limits based on your Supabase plan\n\n## Use Cases\n\n**Good for Realtime in bash:**\n- Development/debugging tools\n- Simple monitoring scripts\n- Log streaming\n- Testing realtime functionality\n\n**Better in other languages:**\n- Production chat applications\n- Complex presence tracking\n- Multi-channel coordination\n- Auto-reconnection requirements\n\n## API Documentation\n\nFull Supabase Realtime documentation: https://supabase.com/docs/guides/realtime",
  "verticals": [
    "data"
  ],
  "tags": [],
  "author": {
    "name": "Nice-Wolf-Studio",
    "github": "Nice-Wolf-Studio"
  },
  "status": "ready",
  "verified": false,
  "visibility": "public",
  "license": "MIT",
  "links": {
    "repo": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills",
    "skill_md": "https://raw.githubusercontent.com/Nice-Wolf-Studio/claude-code-supabase-skills/main/skills/supabase-realtime/SKILL.md"
  },
  "stats": {
    "stars": 7,
    "forks": 0,
    "installs": 0
  },
  "last_updated": "2026-01-02T07:56:55Z",
  "created_at": "2025-10-20T05:33:10Z",
  "meta": {
    "source": "github",
    "sourceUrl": "https://github.com/Nice-Wolf-Studio/claude-code-supabase-skills/blob/main/skills/supabase-realtime/SKILL.md",
    "harvestedAt": "2026-01-07T16:59:54.890Z",
    "uniqueId": "sk_997068bca9c2"
  }
}