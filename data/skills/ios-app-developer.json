{
  "id": "ios-app-developer",
  "name": "developing-ios-apps",
  "version": "1.0.0",
  "summary": "Develops iOS applications with XcodeGen, SwiftUI, and SPM. Triggers on XcodeGen project.yml configuration, SPM dependency issues, device deployment problems, code signing errors...",
  "description": "# iOS App Development\n\nBuild, configure, and deploy iOS applications using XcodeGen and Swift Package Manager.\n\n## Critical Warnings\n\n| Issue | Cause | Solution |\n|-------|-------|----------|\n| \"Library not loaded: @rpath/Framework\" | XcodeGen doesn't auto-embed SPM dynamic frameworks | **Build in Xcode GUI first** (not xcodebuild). See [Troubleshooting](#spm-dynamic-framework-not-embedded) |\n| `xcodegen generate` loses signing | Overwrites project settings | Configure in `project.yml` target settings, not global |\n| Command-line signing fails | Free Apple ID limitation | Use Xcode GUI or paid developer account ($99/yr) |\n| \"Cannot be set when automaticallyAdjustsVideoMirroring is YES\" | Setting `isVideoMirrored` without disabling automatic | Set `automaticallyAdjustsVideoMirroring = false` first. See [Camera](#camera--avfoundation) |\n\n## Quick Reference\n\n| Task | Command |\n|------|---------|\n| Generate project | `xcodegen generate` |\n| Build simulator | `xcodebuild -destination 'platform=iOS Simulator,name=iPhone 17' build` |\n| Build device (paid account) | `xcodebuild -destination 'platform=iOS,name=DEVICE' -allowProvisioningUpdates build` |\n| Clean DerivedData | `rm -rf ~/Library/Developer/Xcode/DerivedData/PROJECT-*` |\n| Find device name | `xcrun xctrace list devices` |\n\n## XcodeGen Configuration\n\n### Minimal project.yml\n\n```yaml\nname: AppName\noptions:\n  bundleIdPrefix: com.company\n  deploymentTarget:\n    iOS: \"16.0\"\n\nsettings:\n  base:\n    SWIFT_VERSION: \"6.0\"\n\npackages:\n  SomePackage:\n    url: https://github.com/org/repo\n    from: \"1.0.0\"\n\ntargets:\n  AppName:\n    type: application\n    platform: iOS\n    sources:\n      - path: AppName\n    settings:\n      base:\n        INFOPLIST_FILE: AppName/Info.plist\n        PRODUCT_BUNDLE_IDENTIFIER: com.company.appname\n        CODE_SIGN_STYLE: Automatic\n        DEVELOPMENT_TEAM: TEAM_ID_HERE\n    dependencies:\n      - package: SomePackage\n```\n\n### Code Signing Configuration\n\n**Personal (free) account**: Works in Xcode GUI only. Command-line builds require paid account.\n\n```yaml\n# In target settings\nsettings:\n  base:\n    CODE_SIGN_STYLE: Automatic\n    DEVELOPMENT_TEAM: TEAM_ID  # Get from Xcode → Settings → Accounts\n```\n\n**Get Team ID**:\n```bash\nsecurity find-identity -v -p codesigning | head -3\n```\n\n## iOS Version Compatibility\n\n### API Changes by Version\n\n| iOS 17+ Only | iOS 16 Compatible |\n|--------------|-------------------|\n| `.onChange { old, new in }` | `.onChange { new in }` |\n| `ContentUnavailableView` | Custom VStack |\n| `AVAudioApplication` | `AVAudioSession` |\n| `@Observable` macro | `@ObservableObject` |\n| SwiftData | CoreData/Realm |\n\n### Lowering Deployment Target\n\n1. Update `project.yml`:\n```yaml\ndeploymentTarget:\n  iOS: \"16.0\"\n```\n\n2. Fix incompatible APIs:\n```swift\n// iOS 17\n.onChange(of: value) { oldValue, newValue in }\n// iOS 16\n.onChange(of: value) { newValue in }\n\n// iOS 17\nContentUnavailableView(\"Title\", systemImage: \"icon\")\n// iOS 16\nVStack {\n    Image(systemName: \"icon\").font(.system(size: 48))\n    Text(\"Title\").font(.title2.bold())\n}\n\n// iOS 17\nAVAudioApplication.shared.recordPermission\n// iOS 16\nAVAudioSession.sharedInstance().recordPermission\n```\n\n3. Regenerate: `xcodegen generate`\n\n## Device Deployment\n\n### First-time Setup\n\n1. Connect device via USB\n2. Trust computer on device\n3. In Xcode: Settings → Accounts → Add Apple ID\n4. Select device in scheme dropdown\n5. Run (`Cmd + R`)\n6. On device: Settings → General → VPN & Device Management → Trust\n\n### Command-line Build (requires paid account)\n\n```bash\nxcodebuild \\\n  -project App.xcodeproj \\\n  -scheme App \\\n  -destination 'platform=iOS,name=DeviceName' \\\n  -allowProvisioningUpdates \\\n  build\n```\n\n### Common Issues\n\n| Error | Solution |\n|-------|----------|\n| \"Library not loaded: @rpath/Framework\" | SPM dynamic framework not embedded. Build in Xcode GUI first, then CLI works |\n| \"No Account for Team\" | Add Apple ID in Xcode Settings → Accounts |\n| \"Provisioning profile not found\" | Free account limitation. Use Xcode GUI or get paid account |\n| Device not listed | Reconnect USB, trust computer on device, restart Xcode |\n| DerivedData won't delete | Close Xcode first: `pkill -9 Xcode && rm -rf ~/Library/Developer/Xcode/DerivedData/PROJECT-*` |\n\n### Free vs Paid Developer Account\n\n| Feature | Free Apple ID | Paid ($99/year) |\n|---------|---------------|-----------------|\n| Xcode GUI builds | ✅ | ✅ |\n| Command-line builds | ❌ | ✅ |\n| App validity | 7 days | 1 year |\n| App Store | ❌ | ✅ |\n| CI/CD | ❌ | ✅ |\n\n## SPM Dependencies\n\n### SPM Dynamic Framework Not Embedded\n\n**Root Cause**: XcodeGen doesn't generate the \"Embed Frameworks\" build phase for SPM dynamic frameworks (like RealmSwift, Realm). The app builds successfully but crashes on launch with:\n\n```\ndyld: Library not loaded: @rpath/RealmSwift.framework/RealmSwift\n  Referenced from: /var/containers/Bundle/Application/.../App.app/App\n  Reason: image not found\n```\n\n**Why This Happens**:\n- Static frameworks (most SPM packages) are linked into the binary - no embedding needed\n- Dynamic frameworks (RealmSwift, etc.) must be copied into the app bundle\n- XcodeGen generates link phase but NOT embed phase for SPM packages\n- `embed: true` in project.yml causes build errors (XcodeGen limitation)\n\n**The Fix** (Manual, one-time per project):\n1. Open project in Xcode GUI\n2. Select target → General → Frameworks, Libraries\n3. Find the dynamic framework (RealmSwift)\n4. Change \"Do Not Embed\" → \"Embed & Sign\"\n5. Build and run from Xcode GUI first\n\n**After Manual Fix**: Command-line builds (`xcodebuild`) will work because Xcode persists the embed setting in project.pbxproj.\n\n**Identifying Dynamic Frameworks**:\n```bash\n# Check if a framework is dynamic\nfile ~/Library/Developer/Xcode/DerivedData/PROJECT-*/Build/Products/Debug-iphoneos/FRAMEWORK.framework/FRAMEWORK\n# Dynamic: \"Mach-O 64-bit dynamically linked shared library\"\n# Static: \"current ar archive\"\n```\n\n### Adding Packages\n\n```yaml\npackages:\n  AudioKit:\n    url: https://github.com/AudioKit/AudioKit\n    from: \"5.6.5\"\n  RealmSwift:\n    url: https://github.com/realm/realm-swift\n    from: \"10.54.6\"\n\ntargets:\n  App:\n    dependencies:\n      - package: AudioKit\n      - package: RealmSwift\n        product: RealmSwift  # Explicit product name when package has multiple\n```\n\n### Resolving Dependencies (China proxy)\n\n```bash\ngit config --global http.proxy http://127.0.0.1:1082\ngit config --global https.proxy http://127.0.0.1:1082\nxcodebuild -scmProvider system -resolvePackageDependencies\n```\n\n**Never clear global SPM cache** (`~/Library/Caches/org.swift.swiftpm`). Re-downloading is slow.\n\n## Camera / AVFoundation\n\nCamera preview requires real device (simulator has no camera).\n\n### Quick Debugging Checklist\n\n1. **Permission**: Added `NSCameraUsageDescription` to Info.plist?\n2. **Device**: Running on real device, not simulator?\n3. **Session running**: `session.startRunning()` called on background thread?\n4. **View size**: UIViewRepresentable has non-zero bounds?\n5. **Video mirroring**: Disabled `automaticallyAdjustsVideoMirroring` before setting `isVideoMirrored`?\n\n### Video Mirroring (Front Camera)\n\n**CRITICAL**: Must disable automatic adjustment before setting manual mirroring:\n\n```swift\n// WRONG - crashes with \"Cannot be set when automaticallyAdjustsVideoMirroring is YES\"\nconnection.isVideoMirrored = true\n\n// CORRECT - disable automatic first\nconnection.automaticallyAdjustsVideoMirroring = false\nconnection.isVideoMirrored = true\n```\n\n### UIViewRepresentable Sizing Issue\n\nUIViewRepresentable in ZStack may have zero bounds. Fix with explicit frame:\n\n```swift\n// BAD: UIViewRepresentable may get zero size in ZStack\nZStack {\n    CameraPreviewView(session: session)  // May be invisible!\n    OtherContent()\n}\n\n// GOOD: Explicit sizing\nZStack {\n    GeometryReader { geo in\n        CameraPreviewView(session: session)\n            .frame(width: geo.size.width, height: geo.size.height)\n    }\n    .ignoresSafeArea()\n    OtherContent()\n}\n```\n\n### Debug Logging Pattern\n\nAdd logging to trace camera flow:\n\n```swift\nimport os\nprivate let logger = Logger(subsystem: \"com.app\", category: \"Camera\")\n\nfunc start() async {\n    logger.info(\"start() called, isRunning=\\(self.isRunning)\")\n    // ... setup code ...\n    logger.info(\"session.startRunning() completed\")\n}\n\n// For CGRect (doesn't conform to CustomStringConvertible)\nlogger.info(\"bounds=\\(NSCoder.string(for: self.bounds))\")\n```\n\nFilter in Console.app by subsystem.\n\n**For detailed camera implementation**: See [references/camera-avfoundation.md](references/camera-avfoundation.md)\n\n## Resources\n\n- [references/xcodegen-full.md](references/xcodegen-full.md) - Complete project.yml options\n- [references/swiftui-compatibility.md](references/swiftui-compatibility.md) - iOS version API differences\n- [references/camera-avfoundation.md](references/camera-avfoundation.md) - Camera preview debugging\n- [references/testing-mainactor.md](references/testing-mainactor.md) - Testing @MainActor classes (state machines, regression tests)",
  "verticals": [
    "engineering",
    "operations",
    "design"
  ],
  "tags": [],
  "author": {
    "name": "daymade",
    "github": "daymade"
  },
  "status": "ready",
  "verified": false,
  "visibility": "public",
  "license": "MIT",
  "links": {
    "repo": "https://github.com/daymade/claude-code-skills",
    "skill_md": "https://raw.githubusercontent.com/daymade/claude-code-skills/main/iOS-APP-developer/SKILL.md"
  },
  "stats": {
    "stars": 154,
    "forks": 13,
    "installs": 0
  },
  "last_updated": "2026-01-07T15:30:48Z",
  "created_at": "2025-10-22T11:17:31Z",
  "meta": {
    "source": "github",
    "sourceUrl": "https://github.com/daymade/claude-code-skills/blob/main/iOS-APP-developer/SKILL.md",
    "harvestedAt": "2026-01-07T16:59:54.890Z",
    "uniqueId": "sk_77c441b65dad"
  }
}